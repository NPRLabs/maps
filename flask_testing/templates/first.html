<!DOCTYPE html>
<html>
<head>
	<title>Leaflet Quick Start Guide Example</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css">
</head>

<body>
  {% if name %}
  <h1>HELLO {{ name}} </h1>
  {% else %}
  <h1>HELLO NOONE </h1>
  {% endif %}
	<div id="mapid" style="width: 1000px; height: 1000px"></div>

	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    
	<script>
		var mymap = L.map('mapid')

		L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
		}).addTo(mymap);
		
		var geojsonMarkerOptions = {
            radius: 300,
            fillColor: "#f33",
            color: "#f33",
            weight: 1,
            opacity: 1,
            fillOpacity: 0.8
        };
        var popup = L.popup()
        mymap.on('load', function() {
        bounds = mymap.getBounds()
        $.getJSON(
        '/json/' + bounds.getWest() + '/' + bounds.getSouth()
        + '/'+ bounds.getEast() + '/' + bounds.getNorth() ,    
      function( test_json ) {
        L.geoJson(test_json, {
          pointToLayer: function (feature, latlng) {
              return L.circle(latlng, 300, geojsonMarkerOptions)
                      .on('click', function(e){
                          popup
                                  .setLatLng(latlng)
                          .setContent(JSON.stringify(feature.properties))
                          .openOn(mymap);
                          })
                      .on('mouseover', function(e){
                              e.target.setRadius(1000);
                          })
                      .on('mouseout', function(e){
                              e.target.setRadius(300);
                              mymap.closePopup()
                          })
           }}).addTo(mymap);
      })
      })
      mymap.setView([40.7128, -74.0059], 13);
		

	</script>
</body>
</html>

